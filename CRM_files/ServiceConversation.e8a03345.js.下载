(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ServiceConversation"],{"282f":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"service-conversation"},[t._l(t.list,(function(e,i){return s("div",{key:i,staticClass:"conversation-list"},[s("div",{staticClass:"start-time"},[t._v(t._s(e.startTime.split(" ")[0]))]),e.chatUrl||e.sittingUrl?s("div",{staticClass:"page-url"},[e.sittingUrl?s("p",[t._v("落地页链接："),s("a",{attrs:{target:"_blank",href:e.sittingUrl}},[t._v(t._s(e.sittingUrl))])]):t._e(),e.chatUrl?s("p",[t._v("对话页链接："),s("a",{attrs:{target:"_blank",href:e.chatUrl}},[t._v(t._s(e.chatUrl))])]):t._e()]):t._e(),t._l(e.messageList,(function(e,i){return s("ul",{key:i},[s("li",[s("span",[t._v(t._s(0===e.flag?"访客":"客服")+" "+t._s(e.time.split(" ")[1]))]),-1!==e.shortMessage.indexOf("<yxOnlineTag")?s("div",[t.imgType.indexOf(t.stringSplit(e.shortMessage,"type"))>=0?s("img",{staticClass:"msg-img",attrs:{src:t.stringSplit(e.shortMessage,"url")},on:{click:function(i){t.preview(t.stringSplit(e.shortMessage,"url"))}}}):t.fileType.indexOf(t.stringSplit(e.shortMessage,"type"))>0?s("div",{staticClass:"file-box",on:{click:function(i){t.downloadFile(t.stringSplit(e.shortMessage,"url"),t.stringSplit(e.shortMessage,">"))}}},[s("h5",[t._v(t._s(t.stringSplit(e.shortMessage,">")))])]):t._e()]):s("p",{class:0===e.flag?"visitor":"service"},[t._v(t._s(e.shortMessage))])])])})),0===e.pullflag?s("div",{staticClass:"update-btn",on:{click:function(s){return t.update(i,e.id)}}},[s("i",{staticClass:"icon iconfont icon-gengxin1"}),s("span",[t._v("更新对话信息")])]):t._e()],2)})),0===t.list.length||t.exsitNextPage?t._e():s("p",{staticClass:"no-data-text"},[t._v("暂无更多")]),t.exsitNextPage?s("p",{staticClass:"load-text"},[s("a-spin",{staticStyle:{"margin-right":"10px"},attrs:{spinning:t.spinning,color:"#2C80FF"}},[s("a-icon",{staticStyle:{"font-size":"12px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1),s("span",{on:{click:t.loadMore}},[t._v(t._s(t.spinning?"正在加载":"加载更多"))])],1):t._e(),0===t.list.length?s("div",{staticClass:"no-data"},[s("img",{attrs:{src:i("9485")}}),s("p",[t._v("暂无数据")])]):t._e(),s("a-modal",{attrs:{visible:t.previewVisible,width:"930px",footer:null},on:{cancel:t.handleCancel}},[s("img",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{alt:"example",src:t.previewImage}})])],2)},n=[],a=(i("99af"),i("d3b7"),i("ac1f"),i("25f0"),i("1276"),i("0bb4")),r=i("aeb1"),o=i.n(r),l={name:"ServiceConversation",components:{},props:{customerId:{type:String,default:"",required:!1},isLoad:{type:String,default:"",required:!1}},data:function(){return{flag:0,pageNo:1,pageSize:10,list:[],exsitNextPage:!1,previewImage:"",previewVisible:!1,imgType:["png","jpg","gif","jpeg"],fileType:["xls","xlsx","doc","docx","pdf","pptx","txt","zip","rar","mp4","mp3","log"]}},watch:{isLoad:function(t,e){"客服对话"===t&&(this.pageNo=1,this.list=[],this.getServiceSession())},customerId:function(t,e){t&&(this.pageNo=1,this.list=[],this.exsitNextPage=!1,this.getServiceSession())}},mounted:function(){this.getServiceSession()},methods:{stringSplit:function(t,e){var i="'",s=e+"='";return">"===e&&(i="<",s=">"),t.split(s)[1].split(i)[0]},preview:function(t){this.previewImage=t,this.previewVisible=!0},handleCancel:function(){this.previewVisible=!1},downloadFile:function(t,e){var i="https://image.yunduoketang.com/"+t,s=new XMLHttpRequest;s.open("GET",i,!0),s.responseType="blob",s.onload=function(t){o()(s.response,e)},s.send()},getServiceSession:function(){var t=this;Object(a["T"])({customerId:this.customerId,pageNo:this.pageNo,pageSize:this.pageSize}).then((function(e){200===e.code?(e.data&&(e.data.list&&e.data.list.length>0&&(t.list=t.list.concat(e.data.list)),t.exsitNextPage=e.data.exsitNextPage),t.spinning=!1):t.$message.error(e.msg+"请稍后重试")}))},loadMore:function(){this.spinning||(this.pageNo++,this.spinning=!0,this.getServiceSession())},update:function(t,e){var i=this;Object(a["W"])({oid:e.toString()}).then((function(e){if(200===e.code){i.$set(i.list,t,e.data);var s=new Date,n=s.toLocaleString();i.$message.success("更新对话成功！更新时间："+n)}else i.$message.error(e.msg+"请稍后重试")}))}}},c=l,g=(i("afc9"),i("0c7c")),p=Object(g["a"])(c,s,n,!1,null,"b6759464",null);e["default"]=p.exports},"4ce3":function(t,e,i){},afc9:function(t,e,i){"use strict";i("4ce3")}}]);